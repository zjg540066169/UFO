<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>UFO in USA</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_tidy.html">Tidy Data</a>
</li>
<li>
  <a href="EDA.html">EDA</a>
</li>
<li>
  <a href="UFO_in_USA.html">UFO in USA</a>
</li>
<li>
  <a href="https://ljf123-final.shinyapps.io/shiny_dashboard_jl/">Map of City</a>
</li>
<li>
  <a href="UFO_prediction.html">Models</a>
</li>
<li>
  <a href="https://zjg540066169.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">UFO in USA</h1>

</div>


<div id="visualization-of-ufo-in-usa" class="section level1">
<h1><em>Visualization of UFO in USA</em></h1>
<p>The goal of this part is to explore whether there exist any association between the shape of UFOs and their appearance in the U.S, as well as to detect if there is any potential correlation between shape of UFOs and their encounter length time.</p>
</div>
<div id="the-distribution-of-ufo-shape-in-the-u.s" class="section level1">
<h1>The Distribution of UFO Shape in the U.S</h1>
<p><strong> Boxplot showing the distribution of the UFO Shape Observed in US </strong>.</p>
<pre class="r"><code>### Boxplot showing the distribution of the UFO Shape Observed in US

ufo =
ufo_data %&gt;%  
#separate(date_time, into = c( &quot;date&quot;,&quot;time&quot;), sep = &quot; &quot; ) %&gt;%
separate( date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;% 
  filter(country == &quot;USA&quot;,year &gt;= 1950) %&gt;%
  group_by(state) %&gt;%
  count(ufo_shape) %&gt;%
  arrange(desc(n)) %&gt;% 
  ungroup %&gt;% 
  mutate(
  ufo_shape = factor(ufo_shape),
  ufo_shape = forcats::fct_reorder(ufo_shape, n)) %&gt;%
  ggplot(aes(x = ufo_shape, y = n, group = ufo_shape)) +
  geom_boxplot(aes(color =ufo_shape)) +
  theme(axis.text.x = element_text(angle = 300)) +
  labs(
    title = &quot;Boxplot Showing Distribution of the UFO Shape Observed in the U.S.&quot;,
    x = &quot;UFO Shape&quot;,
    y = &quot;Number&quot;
  ) +
  theme(plot.title = element_text(hjust = 0.5))

ufo</code></pre>
<p><img src="UFO_in_USA_files/figure-html/boxplot_shape_distribution-1.png" width="90%" /></p>
<p>According to this plot, we can see that the light UFO shape was sighted most often, and the changed shape was the least often according to their medium value. Some of the most common sighted UFO shapes are light, trianle, circle, unknown, other, and fireball, disk, and sphere. Some of the least common sighted UFO shapes are changed crescent, delta, flare, hezagon, pyramid and round.</p>
<p>After seeing the distribution of shape and UFO sighting frequency, we are trying to explore whether the frequency of UFO shape changes by day and night. In general, the UFOs are more likely to be observed during night and the shape of light is the most frequent shape during night as indicated by the plot below.</p>
<p><strong> Times of Appearance for Each Shape of UFO (by day and night) </strong></p>
<pre class="r"><code>ufo_day_night_shape =
ufo_data %&gt;%  
separate(date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;%
separate(time, into = c(&quot;hour&quot;,&quot;minute&quot;), sep = &quot;:&quot;) %&gt;% 
mutate(hour=recode(hour, &quot;00&quot;=&quot;24&quot;)) %&gt;% 
filter(country == &quot;USA&quot;) %&gt;% 
mutate(year_1 = case_when(year &gt;= 1950 ~ &quot;true&quot;,
                          TRUE ~&quot;false&quot;)) %&gt;% 
filter(year_1 == &quot;true&quot;) %&gt;% 
select(-year_1) %&gt;% 
mutate(hour = as.numeric(hour)) %&gt;% 
mutate(night_day = case_when(18 &lt;= hour &amp; hour &lt;= 24~ &quot;night&quot;,
                             1 &lt;= hour &amp; hour &lt;= 6 ~ &quot;night&quot;,
                             TRUE ~ &quot;day&quot;)) %&gt;% 
group_by(ufo_shape, night_day) %&gt;% 
summarize(count_shape = n()) %&gt;% 
  ggplot(aes(x = ufo_shape, y = count_shape, group = night_day)) +
  geom_col(aes(fill = night_day), alpha = .75, position = position_dodge(1)) +
  scale_fill_manual(
    values = c(&quot;lightblue&quot;,&quot;lightpink&quot;), 
    labels = c(&quot;day&quot;,&quot;night&quot;)
    ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = &quot;Times of Appearance for Each Shape of UFO (by day and night)&quot;, 
       y = &quot;counts&quot;,
       x = &quot;UFO Shape&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
  
  ufo_day_night_shape</code></pre>
<p><img src="UFO_in_USA_files/figure-html/day_night_shape-1.png" width="90%" /></p>
<p>The spagetti plot below confirms that UFOs are more likely to appear during night, since the frequency of appearance dramatically after 6pm.</p>
<p><strong> Numbers of appearance of UFO in each hour by month </strong></p>
<pre class="r"><code>plot_us_month = ufo_data %&gt;% 
  #separate(date_time, into = c( &quot;date&quot;,&quot;time&quot;), sep = &quot; &quot; ) %&gt;%
  separate( date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;% 
  filter(country == &quot;USA&quot;,year &gt;= 1950) %&gt;%
  separate(time, into = c(&quot;hour&quot;, &quot;minute&quot;), sep = &quot;:&quot;) %&gt;% 
  mutate(hour = paste0(hour, &quot;:00-&quot;, hour, &quot;:59&quot;)) %&gt;% 
  select(-minute) %&gt;% 
  mutate(month = month.name[as.numeric(month)]) %&gt;% 
  group_by(hour, ufo_shape) %&gt;% 
  summarize(n = n()) %&gt;% 
  ggplot(aes(x = hour, y = n, color = ufo_shape)) +
  geom_line(aes(group = ufo_shape)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(
    title = &quot;Number of UFO in Each Hour by Month in US&quot;,
    x = &quot;Hour&quot;,
    y = &quot;Number&quot;
  ) +
  theme(plot.title = element_text(hjust = 0.5))

# display the plot
plot_us_month</code></pre>
<p><img src="UFO_in_USA_files/figure-html/spagetti_appearance_each_hour-1.png" width="90%" /></p>
<p><em>Conclusion:</em> 1):The most frequent shape of UFO is light; 2):The UFO is more likely to appear during night.</p>
</div>
<div id="monthyear-vs.-encounter-length-time" class="section level1">
<h1>Month/Year vs. Encounter length time</h1>
<pre class="r"><code>## USA
ufo =
ufo_data %&gt;%  
separate( date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;)

  ufo %&gt;%
  filter(country == &quot;USA&quot;, year &gt;= 1950, encounter_length &lt;6000) %&gt;%
  select(year, month, encounter_length) %&gt;%
  mutate(year = as.numeric(year),
         month = as.numeric(month)) %&gt;%
  group_by(year,month) %&gt;%
  arrange(desc(month)) %&gt;%
  mutate(
  ave_encountered_length = mean(encounter_length/60)) %&gt;%
  select(-encounter_length) %&gt;%
  ungroup() %&gt;%
  mutate(month = month.name[as.numeric(month)]) %&gt;%
  ggplot(aes(x = year, y = month)) +
  geom_tile(aes(fill = ave_encountered_length), colour = &quot;white&quot;) +
  scale_fill_gradient(low = &quot;lightyellow&quot;, high = &quot;darkblue&quot;) +
  scale_x_continuous(name=&quot;Years&quot;, 
                     breaks = c(1950, 1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005,2010,2015
                                ), limits= c (1950,2015)) +
  labs(
    title = &quot;Average UFO Encounter Length Compared among Months Across Time in USA &quot;,
    x = &quot;Years&quot;,
    y = &quot;Month&quot;
  ) + 
  theme(axis.text.x = element_text(angle = 300)) +
  #theme(plot.subtitle = element_text(hjust = 0.5)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="UFO_in_USA_files/figure-html/unnamed-chunk-1-1.png" width="90%" /></p>
<p>The above plot shows that there are more observations with lower encounter length time after the year of 1990.</p>
</div>
<div id="shape-vs.-encounter-length-time" class="section level1">
<h1>Shape vs. Encounter length time</h1>
<p><strong>The violin plot of encounter length for each shape of ufo &amp; The bar chart of the median of encounter length time for each shape of UFO </strong></p>
<pre class="r"><code># tidy data
length_shape_data = ufo_data %&gt;% 
  mutate(ufo_shape = factor(ufo_shape),
         ufo_shape = forcats::fct_reorder(ufo_shape, encounter_length))

# violin plot 
length_shape_data %&gt;% 
  ggplot(aes(x = ufo_shape, y = encounter_length, group = ufo_shape)) +
  geom_violin(aes(fill = ufo_shape), color = &quot;cornsilk4&quot;, alpha = 0.4) +
  theme(axis.text.x = element_text(angle = 300)) +
  stat_summary(fun.y = median, geom = &quot;point&quot;, color = &quot;darksalmon&quot;, size = 3) +
  labs(title = &quot;The Violin Plot of Encounter Length Time for Each Shape of UFO&quot;, 
       y = &quot;Encounter Length of Time&quot;,
       x = &quot;UFO Shape&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="UFO_in_USA_files/figure-html/violin_plot_bar_chart-1.png" width="90%" /></p>
<pre class="r"><code># tidy data for the bar chart
median_length_shape_data = ufo_data %&gt;% 
  group_by(ufo_shape) %&gt;% 
  summarize(median_length = median(encounter_length), 
            count = n()) %&gt;% 
  filter(count &gt; 100) %&gt;% 
  arrange(desc(median_length)) %&gt;% 
  ungroup()

# bar chart
median_length_shape_data %&gt;% 
  ggplot(aes(x = ufo_shape, y = median_length, fill = ufo_shape)) + 
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 300)) +
  labs(title = &quot;The Bar Chart of Median of Encounter Length Time for Each Shape of UFO&quot;,
       y = &quot;Median of Encounter Length Time&quot;,
       x = &quot;UFO Shape&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="UFO_in_USA_files/figure-html/violin_plot_bar_chart-2.png" width="90%" /></p>
<p>The violin plot here doesn’t actually indicate much because the existence of outliers in several shapes, but we also can see that the medium (indicated by the pink dots) most of UFO encounter time length regardless of their shapes are small.</p>
<p>The bar chart is a more in-depth view on median of UFO encounter length by shape. The median for the changing shape has the largest median (slightly over 400 seconds), and the smallest median of UFO encounter length is flash (slighter fewer than 50 seconds).</p>
<p><strong>The Median Length Time for Each Shape of UFO (by day and night) </strong></p>
<p>Whether the relationship between shape and the length time would change by time</p>
<pre class="r"><code>ufo_day_night_length =
ufo_data %&gt;%  
# separate(date_time, into = c( &quot;date&quot;,&quot;time&quot;), sep = &quot; &quot; ) %&gt;%
separate(date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;%
separate(time, into = c(&quot;hour&quot;,&quot;minute&quot;), sep = &quot;:&quot;) %&gt;% 
mutate(hour=recode(hour, &quot;00&quot;=&quot;24&quot;)) %&gt;% 
filter(country == &quot;USA&quot;) %&gt;% 
mutate(year_1 = case_when(year &gt;= 1950 ~ &quot;true&quot;,
                          TRUE ~&quot;false&quot;)) %&gt;% 
filter(year_1 == &quot;true&quot;) %&gt;% 
select(-year_1) %&gt;% 
mutate(hour = as.numeric(hour)) %&gt;% 
mutate(night_day = case_when(18 &lt;= hour &amp; hour &lt;= 24~ &quot;night&quot;,
                             1 &lt;= hour &amp; hour &lt;= 6 ~ &quot;night&quot;,
                             TRUE ~ &quot;day&quot;)) %&gt;% 
  group_by(ufo_shape, night_day) %&gt;% 
           summarize(median_length = median(encounter_length),
count = n()) %&gt;% 
  filter(count &gt; 100) %&gt;% 
  ggplot(aes(x = ufo_shape, y = median_length, group = night_day)) +
  geom_col(aes(fill = night_day), alpha = .75, position = position_dodge(1)) +
  scale_fill_manual(
    values = c(&quot;lightblue&quot;,&quot;lightpink&quot;), 
    labels = c(&quot;day&quot;,&quot;night&quot;)
    ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = &quot;The Median Length Time for Each Shape of UFO (by day and night)&quot;, 
       y = &quot;median length&quot;,
       x = &quot;UFO Shape&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
  
  ufo_day_night_length</code></pre>
<p><img src="UFO_in_USA_files/figure-html/length_day_night-1.png" width="90%" /></p>
<p>The plot did not display any particular pattern or trend over the shape of UFO, hence we conclude that there is no association between encounter length time and UFO shape.</p>
</div>
<div id="ufo-appearance-in-each-month" class="section level1">
<h1>UFO Appearance in Each Month</h1>
<pre class="r"><code>ufo_month_counts_plot =
ufo_data %&gt;%  
# separate(date_time, into = c( &quot;date&quot;,&quot;time&quot;), sep = &quot; &quot; ) %&gt;%
separate(date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;%
filter(country == &quot;USA&quot;) %&gt;% 
mutate(year_1 = case_when(year &gt;= 1950 ~ &quot;true&quot;,
                          TRUE ~&quot;false&quot;)) %&gt;% 
mutate(month = forcats::fct_relevel(month, c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;))) %&gt;% 
mutate(month = recode(month,&quot;1&quot;=&quot;Jan&quot;,&quot;2&quot;=&quot;Feb&quot;,&quot;3&quot;=&quot;Mar&quot;,&quot;4&quot;=&quot;Apr&quot;,&quot;5&quot;=&quot;May&quot;,&quot;6&quot;=&quot;Jun&quot;,&quot;7&quot;=&quot;Jul&quot;,&quot;8&quot;=&quot;Aug&quot;,&quot;9&quot;=&quot;Sep&quot;,&quot;10&quot;=&quot;Oct&quot;,&quot;11&quot;=&quot;Nov&quot;,&quot;12&quot;=&quot;Dec&quot;)) %&gt;% 
filter(year_1 == &quot;true&quot;) %&gt;% 
select(-year_1) %&gt;% 
group_by(month) %&gt;% 
summarize(count_month = n()) %&gt;% 
  ggplot(aes(x = month, y = count_month)) +
  geom_col(aes(fill = month), alpha = .75, position = position_dodge(1)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = &quot;The Plot of the Appearance UFO for Each Month&quot;, 
       y = &quot;Counts of Appearance&quot;,
       x = &quot;Month&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
  
ufo_month_counts_plot</code></pre>
<p><img src="UFO_in_USA_files/figure-html/ufo_appearance_month-1.png" width="90%" /></p>
<p>According to the plot here, the number of appearance by month of UFO is lower during the first half of the year and higher during the second half of the year. In other words, the frequency of UFO appearance is higher after June, and peaks at July.</p>
<p><em>Conclusion:</em> 1):There is no association between the shape of UFO and encounter length time; 2):The UFO is more likely to appear during the second half of the year.</p>
</div>
<div id="lasso-length-time-vs.-location-time-shape" class="section level1">
<h1><em>LASSO (length time vs. location, time, shape)</em></h1>
<p>After the visualization, we are interested in predicting and finding the association between the encounter length time with UFO shape, sighting location and sighting time. In order to make a accurate prediction, we use Lasso model to find the best fit. The reason for adapting Lasso model is that the parameter in the model will be large, and Lasso will give tune the parameters automatically into their best fit.</p>
<pre class="r"><code># Read Dataset
ufo =
  ufo_data %&gt;%  
  filter(country == &quot;USA&quot;) %&gt;% 
  #na.omit(ufo_data) %&gt;% 
  #separate(date_time, into = c( &quot;date&quot;,&quot;time&quot;), sep = &quot; &quot; ) %&gt;%
  separate(date, into = c(&quot;month&quot;,&quot;day&quot;,&quot;year&quot;), sep = &quot;/&quot;) %&gt;% 
  separate(time, into = c(&quot;hour&quot;,&quot;minute&quot;), sep = &quot;:&quot;) %&gt;% 
  mutate(month = as.factor(month.name[as.numeric(month)]), year = as.numeric(year), hour = as.numeric(hour), minute = as.numeric(minute), day = as.numeric(day), country = as.factor(country), state = as.factor(state), city = as.factor(city)) %&gt;% 
  mutate(add = paste(state, city)) %&gt;% 
  select(year, month, day, hour, minute, state,  add, ufo_shape, encounter_length) %&gt;% 
  na.omit() #%&gt;% </code></pre>
<pre class="r"><code>x_process = function(df){#get independent variables
  x = 
    df %&gt;% 
    select(-encounter_length) %&gt;% 
    model.matrix( ~ ., .)
  x
}



# make the response variables
y_process = function(df){#get dependent variables
  y = 
    df %&gt;% 
    select(encounter_length) %&gt;% 
    pull(encounter_length)
  y
}</code></pre>
<pre class="r"><code># Run Lasso on the Data, Exclude City
ufo_state = 
  ufo %&gt;% 
  select(-add)

lasso_fit_state = 
  glmnet::glmnet(x = x_process(ufo_state), y = y_process(ufo_state), alpha = 1) %&gt;%  #alpha is the parameters to control the type of elastic net models, when alpha = 1, the elastic net model is equivalent to lasso.
  broom::tidy(.) # clean the result


# draw the plot
lasso_fit_state %&gt;% 
  filter(term != &quot;(Intercept)&quot;) %&gt;% 
  ggplot(aes(x = lambda, estimate, color = term)) + 
  geom_line() + 
  scale_x_reverse() +
  labs(
    title = &quot;Lineplot of the Lasso Estimated Coefficients for Different Lambda&quot;,
    x = &quot;Lambda&quot;,
    y = &quot;Estimated Coefficients&quot;
    ) +
  theme(legend.position = &quot;bottom&quot;) +
  guides(color = guide_legend(nrow = 10, byrow = TRUE)) + 
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="UFO_in_USA_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<pre class="r"><code># cross - validation to calculate the best lambda
lambda_best_state = 
  glmnet::cv.glmnet(x = x_process(ufo_state), y = y_process(ufo_state), alpha = 1, nfolds = 10)


#best lambda
lambda_state = lambda_best_state$lambda.min

# fit the lasso model
lasso_best_fit_state = 
  glmnet::glmnet(x = x_process(ufo_state), y = y_process(ufo_state), alpha = 1, nlambda = 1, lambda = lambda_state) #alpha is the parameters to control the type of elastic net models, when alpha = 1, the elastic net model is equivalent to lasso.

# display the parameters
glmnet::coef.glmnet(lasso_best_fit_state) </code></pre>
<pre><code>## 96 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                              s0
## (Intercept)        5.804124e+03
## (Intercept)        .           
## year               .           
## monthAugust        .           
## monthDecember      .           
## monthFebruary      .           
## monthJanuary       .           
## monthJuly          .           
## monthJune          .           
## monthMarch         .           
## monthMay           .           
## monthNovember      .           
## monthOctober       .           
## monthSeptember     .           
## day                .           
## hour               .           
## minute             .           
## stateAL            .           
## stateAR            1.492455e-11
## stateAZ            .           
## stateCA            .           
## stateCO            .           
## stateCT            .           
## stateDC            .           
## stateDE            .           
## stateFL            .           
## stateGA            .           
## stateHI            .           
## stateI-            .           
## stateIA            .           
## stateID            .           
## stateIL            .           
## stateIN            .           
## stateKS            .           
## stateKY            .           
## stateLA            .           
## stateMA            .           
## stateMD            .           
## stateME            .           
## stateMI            .           
## stateMN            .           
## stateMO            .           
## stateMS            .           
## stateMT            .           
## stateNC            .           
## stateND            .           
## stateNE            .           
## stateNH            .           
## stateNJ            .           
## stateNM            .           
## stateNV            .           
## stateNY            .           
## stateOH            .           
## stateOK            .           
## stateOR            .           
## statePA            .           
## stateRI            .           
## stateSC            .           
## stateSD            .           
## stateTN            .           
## stateTX            .           
## stateUT            .           
## stateVA            .           
## stateVirginia      .           
## stateVT            .           
## stateWA            .           
## stateWest Virginia .           
## stateWI            .           
## stateWV            .           
## stateWY            .           
## ufo_shapechevron   .           
## ufo_shapecigar     .           
## ufo_shapecircle    .           
## ufo_shapecone      .           
## ufo_shapecrescent  .           
## ufo_shapecross     .           
## ufo_shapecylinder  .           
## ufo_shapedelta     .           
## ufo_shapediamond   .           
## ufo_shapedisk      .           
## ufo_shapeegg       .           
## ufo_shapefireball  .           
## ufo_shapeflare     .           
## ufo_shapeflash     .           
## ufo_shapeformation .           
## ufo_shapehexagon   .           
## ufo_shapelight     .           
## ufo_shapeother     .           
## ufo_shapeoval      .           
## ufo_shapepyramid   .           
## ufo_shaperectangle .           
## ufo_shaperound     .           
## ufo_shapesphere    .           
## ufo_shapeteardrop  .           
## ufo_shapetriangle  .           
## ufo_shapeunknown   .</code></pre>
<p>According to the result, none of terms are significant. Hence, we can conclude that the knowledge of state, shape, year, month, day, hour, minute does not contribute any insights on the encounter length of UFO.</p>
<div id="run-lasso-on-data-only-the-city-appeared-more-than-50-times-included" class="section level2">
<h2><em>Run lasso on data, only the city appeared more than 50 times included</em></h2>
<p>We only include cities that has UFO occured more than 50 times, because if not, we would need to adopt high-dimensional models which introduce non-significant terms in the model. To avoid insignificant model, we here only include cities with 50 or more UFO appearances.</p>
<pre class="r"><code>ufo_city = 
  ufo %&gt;% 
  group_by(add) %&gt;% 
  mutate(count = n()) %&gt;% 
  filter(count &gt; 50) %&gt;% 
  ungroup() %&gt;% 
  select(-count) %&gt;% 
  select(-state)
  
lasso_fit_city = 
  glmnet::glmnet(x = x_process(ufo_city), y = y_process(ufo_city), alpha = 1) %&gt;%  #alpha is the parameters to control the type of elastic net models, when alpha = 1, the elastic net model is equivalent to lasso.
  broom::tidy(.) # clean the result


# draw the plot
lasso_fit_city %&gt;% 
  filter(term != &quot;(Intercept)&quot;) %&gt;% 
  ggplot(aes(x = lambda, estimate, color = term)) + 
  geom_line() + 
  scale_x_reverse() +
  labs(
    title = &quot;Lineplot of the Lasso Estimated Coefficients for Different Lambda&quot;,
    x = &quot;Lambda&quot;,
    y = &quot;Estimated Coefficients&quot;
    ) +
  theme(legend.position = &quot;bottom&quot;) +
  guides(color = guide_legend(nrow = 12, byrow = TRUE)) + 
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="UFO_in_USA_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<pre class="r"><code># cross - validation to calculate the best lambda
lambda_best_city = 
  glmnet::cv.glmnet(x = x_process(ufo_city), y = y_process(ufo_city), alpha = 1, nfolds = 10)


#best lambda
lambda_city = lambda_best_city$lambda.min


# fit the lasso model
lasso_best_fit_city = 
  glmnet::glmnet(x = x_process(ufo_city), y = y_process(ufo_city), alpha = 1, nlambda = 1, lambda = lambda_city) #alpha is the parameters to control the type of elastic net models, when alpha = 1, the elastic net model is equivalent to lasso.

# display the parameters
glmnet::coef.glmnet(lasso_best_fit_city) </code></pre>
<pre><code>## 171 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                           s0
## (Intercept)                     2.833291e+03
## (Intercept)                     .           
## year                            .           
## monthAugust                     .           
## monthDecember                   .           
## monthFebruary                   .           
## monthJanuary                    .           
## monthJuly                       .           
## monthJune                       .           
## monthMarch                      .           
## monthMay                        .           
## monthNovember                   .           
## monthOctober                    .           
## monthSeptember                  .           
## day                             .           
## hour                            .           
## minute                          .           
## addAL Birmingham                .           
## addAZ Chandler                  .           
## addAZ Gilbert                   .           
## addAZ Glendale                  .           
## addAZ Lake Havasu City          .           
## addAZ Mesa                      .           
## addAZ Phoenix                   .           
## addAZ Scottsdale                .           
## addAZ Sedona                    .           
## addAZ Surprise                  .           
## addAZ Tempe                     .           
## addAZ Tucson                    .           
## addCA 350 W 1st St, Los Angeles .           
## addCA Bakersfield               .           
## addCA Burbank                   .           
## addCA El Cajon                  .           
## addCA Escondido                 .           
## addCA Fresno                    .           
## addCA Hayward                   .           
## addCA Huntington Beach          .           
## addCA Irvine                    .           
## addCA Long Beach                .           
## addCA Los Angeles               .           
## addCA Modesto                   .           
## addCA Oakland                   .           
## addCA Redding                   .           
## addCA Riverside                 .           
## addCA Sacramento                .           
## addCA San Diego                 .           
## addCA San Francisco             .           
## addCA San Jose                  .           
## addCA Santa Barbara             .           
## addCA Santa Cruz                .           
## addCA Santa Rosa                .           
## addCA Simi Valley               .           
## addCA Ventura                   .           
## addCO Boulder                   .           
## addCO Colorado Springs          .           
## addCO Denver                    .           
## addCO Longmont                  .           
## addFL Fort Lauderdale           .           
## addFL Jacksonville              .           
## addFL Miami                     .           
## addFL Naples                    .           
## addFL Orlando                   .           
## addFL Pensacola                 .           
## addFL Sarasota                  .           
## addFL St. Petersburg            .           
## addFL Tampa                     .           
## addFL West Palm Beach           .           
## addGA Atlanta                   .           
## addHI Honolulu                  .           
## addIA Des Moines                .           
## addID Boise                     .           
## addIL Chicago                   .           
## addIL Rockford                  .           
## addIL Tinley Park               .           
## addIN Indianapolis              .           
## addKS Wichita                   .           
## addKY Lexington                 .           
## addKY Louisville                .           
## addMA Boston                    .           
## addMD Baltimore                 .           
## addMI Detroit                   .           
## addMI Grand Rapids              .           
## addMN Minneapolis               .           
## addMN St Paul                   .           
## addMO Columbia                  .           
## addMO Kansas City               .           
## addMO Springfield               .           
## addMO St. Louis                 .           
## addNC Charlotte                 .           
## addNC Greensboro                .           
## addNC Raleigh                   .           
## addNC Wilmington                .           
## addNE Lincoln                   .           
## addNE Omaha                     .           
## addNM Albuquerque               .           
## addNM Santa Fe                  .           
## addNV Henderson                 .           
## addNV Las Vegas                 .           
## addNV Reno                      .           
## addNY 255 Vesey St, New York    .           
## addNY Brooklyn                  .           
## addNY Buffalo                   .           
## addNY Manhattan, New York       .           
## addNY New York                  .           
## addNY Rochester                 .           
## addNY Staten Island             .           
## addNY The Bronx                 .           
## addOH Cincinnati                .           
## addOH Cleveland                 .           
## addOH Columbus                  .           
## addOH Toledo                    .           
## addOK Oklahoma City             .           
## addOK Tulsa                     .           
## addOR Eugene                    .           
## addOR Hillsboro                 .           
## addOR Portland                  .           
## addOR Salem                     .           
## addPA Philadelphia              .           
## addPA Pittsburgh                .           
## addSC Myrtle Beach              .           
## addSC North Myrtle Beach        .           
## addTN Knoxville                 .           
## addTN Memphis                   .           
## addTN Nashville                 .           
## addTX Arlington                 .           
## addTX Austin                    .           
## addTX Corpus Christi            .           
## addTX Dallas                    .           
## addTX El Paso                   .           
## addTX Fort Worth                .           
## addTX Houston                   .           
## addTX San Antonio               .           
## addUT Salt Lake City            .           
## addVA Richmond                  .           
## addVA Virginia Beach            5.630893e-11
## addWA Auburn                    .           
## addWA Bellevue                  .           
## addWA Bellingham                .           
## addWA Bremerton                 .           
## addWA Everett                   .           
## addWA Olympia                   .           
## addWA Renton                    .           
## addWA Seattle                   .           
## addWA Spokane                   .           
## addWA Tacoma                    .           
## addWA Vancouver                 .           
## addWA Yakima                    .           
## addWI Madison                   .           
## addWI Milwaukee                 .           
## ufo_shapechevron                .           
## ufo_shapecigar                  .           
## ufo_shapecircle                 .           
## ufo_shapecone                   .           
## ufo_shapecross                  .           
## ufo_shapecylinder               .           
## ufo_shapedelta                  .           
## ufo_shapediamond                .           
## ufo_shapedisk                   .           
## ufo_shapeegg                    .           
## ufo_shapefireball               .           
## ufo_shapeflare                  .           
## ufo_shapeflash                  .           
## ufo_shapeformation              .           
## ufo_shapelight                  .           
## ufo_shapeother                  .           
## ufo_shapeoval                   .           
## ufo_shaperectangle              .           
## ufo_shapesphere                 .           
## ufo_shapeteardrop               .           
## ufo_shapetriangle               .           
## ufo_shapeunknown                .</code></pre>
<p>According to the result, most of terms are not statistically significant. The only siginificant term is the city Virginia Beach. However, the coefficient for this term is too small (9.223037e-11), so that we can just ignore. Hence, we can conclude that the knowledge of state, city, shape, month, year, hour, day, mintue does not contribute any insights on the encounter length of UFO.</p>
</div>
</div>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.1">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 6.0px 0.0px; line-height: 14.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p2 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 14.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"><b>Copyright © 2019 UFO Analysis Group All rights reserved.</b></span></p>
</body>
</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
