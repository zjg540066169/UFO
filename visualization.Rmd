---
title: "visualization"
author: "Keyi Wang, Jingyi Tang"
date: "11/8/2019"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
library(plotly)

knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 6, 
  out.width = "90%"
)


options(
  ggplot2.countinuous.colour = "viridis",
  ggplot2.countinuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))

```

## reading data
```{r}
ufo_data = readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv")

ufo =
ufo_data %>%  
na.omit(ufo_data) %>% 
separate(date_time, into = c( "date","time"), sep = " " ) %>%
separate( date, into = c("month","day","year"), sep = "/") 
```


## Number of UFO observed across time among 4 countries --Line Plot
```{r}

```

```{r}
  ## 4 countries plots
  ufo %>% 
  group_by(country,state)%>%
  count(ufo_shape) %>%
  ungroup()%>%
  mutate(
  ufo_shape = factor(ufo_shape),
  ufo_shape = forcats::fct_inorder(ufo_shape, n ),
  country = recode(country , "us" = "United States", 
                             "au" = "Australia",
                             "gb" = "the United Kingdom",
                             "ca" = "Canada")) %>%
  ggplot(aes(x = ufo_shape, y = n )) + geom_boxplot(aes(color = ufo_shape)) +
  theme(axis.text.x = element_text(angle = 300)) +
  facet_grid(. ~ country) +
  labs(
    title = " Boxplot showing distribution of the UFO Shape Observed Among 4 Countries ",
    x = "UFO Shape",
    y = "Number"
  )

### US plot 
  ufo %>%
  filter(country == "us")%>%
  group_by(state) %>%
  count(ufo_shape) %>%
  mutate(
  ufo_shape = factor(ufo_shape),
  ufo_shape = forcats::fct_inorder(ufo_shape, n )) %>%
  ggplot(aes(x = ufo_shape, y = n, group = ufo_shape)) + geom_boxplot(aes(color = ufo_shape)) +
  theme(axis.text.x = element_text(angle = 300)) +
   labs(
    title = " Boxplot showing distribution of the UFO shape Observed in US ",
    x = "UFO Shape",
    y = "Number"
  )


```

