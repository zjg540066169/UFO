---
title: "UFO_Prediction"
author: "Jungang Zou"
date: "11/29/2019"
output: github_document
---

```{r set up, include = FALSE}
# knitr will run the chunk but not include the chunk in the final document
# copy from Jeff

try(source("./dependencies.R"), silent = TRUE)

# ensure reproductivity
set.seed(10)

# load library
library(tidyverse)
library(viridis)
library(ggridges)
library(patchwork)
library(rvest)
library(mapsapi)
library(e1071)
library(ggbiplot)
library(FactoMineR)



knitr::opts_chunk$set(
  # display the code in the code truck above its results in the final document
  echo = TRUE,
  # do not display any warning messages generated by the code
  warning = FALSE,
  # set the figure to be 8 x 6, and the proportion it takes to be 90%
  fig.width = 8,
  fig.height = 6, 
  out.width = "90%"
)

# setting a global options for continuous data color family and a different format to set discrete data to have a color family
options(
  ggplot2.countinuous.colour = "viridis",
  ggplot2.countinuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

# have a minimal theme and legends at the bottom
theme_set(theme_bw() + theme(legend.position = "bottom"))
```


```{r}

ufo_data = read_csv(file = "./data/tidied_data_final.csv")


ufo =
  ufo_data %>%  
  #na.omit(ufo_data) %>% 
  separate(date_time, into = c( "date","time"), sep = " " ) %>%
  separate(date, into = c("month","day","year"), sep = "/") %>% 
  separate(time, into = c("hour","minute"), sep = ":") %>% 
  mutate(month = month.name[as.numeric(month)], year = as.numeric(year), hour = as.numeric(hour), minute = as.numeric(minute), day = as.numeric(day), country = as.factor(country), state = as.factor(state), city = as.factor(city)) %>% 
  select(year, month, day, hour, minute, country, state, city) %>% 
  mutate(ufo_indentification = as.factor(T)) 

model = svm(ufo_indentification ~ ., data = ufo, type = 'one-classification', kernel = "linear")

plot(x = model,data = ufo, formula =  minute ~ year)
```


```{r }
library(e1071)

day = c(0,1,2,3,4,5,6)
weather = c(6,5,4,3,2,1,0) #on the example, it was: c(1,0,0,0,0,0,0)
happy = factor(c(T,T,T,T,T,T,T)) #on the example it was: happy = factor(c(T,F,F,F,F,F,F))

d = data.frame(day=day, weather=weather, happy=happy)
model = svm(happy ~ day + weather, data = d, type='one-classification') #on the example it was: model = svm(happy ~ day + weather, data = d)

plot(model, d)

```